{
  "info": {
    "name": "API Practice Project (Full with Tests)",
    "_postman_id": "00000000-0000-0000-0000-000000000001",
    "description": "Postman collection for learning headers, cookies, JWT, CRUD, error handling using the api-practice-project.",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "Health - GET /health",
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "http://localhost:3000/health",
          "protocol": "http",
          "host": [
            "localhost"
          ],
          "port": "3000",
          "path": [
            "health"
          ]
        }
      },
      "response": [],
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 200\", function () {",
              "  pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test(\"Response has JSON content-type\", function () {",
              "  pm.response.to.have.header(\"Content-Type\");",
              "  pm.expect(pm.response.headers.get(\"Content-Type\")).to.include(\"application/json\");",
              "});",
              "",
              "pm.test(\"Response body contains status: ok\", function () {",
              "  const json = pm.response.json();",
              "  pm.expect(json).to.have.property(\"status\", \"ok\");",
              "});",
              "",
              "pm.test(\"Response has a timestamp field\", function () {",
              "  const json = pm.response.json();",
              "  pm.expect(json).to.have.property(\"timestamp\");",
              "  pm.expect(new Date(json.timestamp).toString()).not.to.equal(\"Invalid Date\");",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ]
    },
    {
      "name": "Test - Headers - GET /test/headers",
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "X-Custom-Header",
            "value": "PostmanTest"
          }
        ],
        "url": {
          "raw": "http://localhost:3000/test/headers",
          "protocol": "http",
          "host": [
            "localhost"
          ],
          "port": "3000",
          "path": [
            "test",
            "headers"
          ]
        }
      },
      "response": [],
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 200\", function () {",
              "  pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test(\"Response contains headers object\", function () {",
              "  const json = pm.response.json();",
              "  pm.expect(json).to.have.property(\"headers\");",
              "});",
              "",
              "pm.test(\"Server echoes X-Custom-Header\", function () {",
              "  const json = pm.response.json();",
              "  const sentHeader = pm.request.headers.get(\"X-Custom-Header\");",
              "  pm.expect(json.headers[\"x-custom-header\"]).to.eql(sentHeader);",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ]
    },
    {
      "name": "Test - Set Cookie - GET /test/set-cookie",
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "http://localhost:3000/test/set-cookie",
          "protocol": "http",
          "host": [
            "localhost"
          ],
          "port": "3000",
          "path": [
            "test",
            "set-cookie"
          ]
        }
      },
      "response": [],
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 200\", function () {",
              "  pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test(\"demoCookie is set in response\", function () {",
              "  pm.response.to.have.header(\"Set-Cookie\");",
              "  const setCookieHeaders = pm.response.headers.filter(h => h.key.toLowerCase() === \"set-cookie\");",
              "  const hasDemoCookie = setCookieHeaders.some(h => h.value.startsWith(\"demoCookie=\"));",
              "  pm.expect(hasDemoCookie).to.be.true;",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ]
    },
    {
      "name": "Test - Get Cookies - GET /test/get-cookies",
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "http://localhost:3000/test/get-cookies",
          "protocol": "http",
          "host": [
            "localhost"
          ],
          "port": "3000",
          "path": [
            "test",
            "get-cookies"
          ]
        }
      },
      "response": [],
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 200\", function () {",
              "  pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test(\"Cookies object contains demoCookie\", function () {",
              "  const json = pm.response.json();",
              "  pm.expect(json).to.have.property(\"cookies\");",
              "  pm.expect(json.cookies).to.have.property(\"demoCookie\");",
              "  pm.expect(json.cookies.demoCookie).to.eql(\"hello-from-server\");",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ]
    },
    {
      "name": "Auth - Login JWT - POST /auth/login-jwt",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"username\": \"testuser\",\n  \"password\": \"password123\"\n}"
        },
        "url": {
          "raw": "http://localhost:3000/auth/login-jwt",
          "protocol": "http",
          "host": [
            "localhost"
          ],
          "port": "3000",
          "path": [
            "auth",
            "login-jwt"
          ]
        }
      },
      "response": [],
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 200\", function () {",
              "  pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test(\"Login response has token\", function () {",
              "  const json = pm.response.json();",
              "  pm.expect(json).to.have.property(\"token\");",
              "  pm.expect(json.token).to.be.a(\"string\");",
              "});",
              "",
              "pm.test(\"Save JWT token to environment\", function () {",
              "  const json = pm.response.json();",
              "  pm.environment.set(\"jwtToken\", json.token);",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ]
    },
    {
      "name": "Auth - Me (JWT protected) - GET /auth/me",
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{jwtToken}}"
          }
        ],
        "url": {
          "raw": "http://localhost:3000/auth/me",
          "protocol": "http",
          "host": [
            "localhost"
          ],
          "port": "3000",
          "path": [
            "auth",
            "me"
          ]
        }
      },
      "response": [],
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status is 200\", function () {",
              "  pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test(\"User info is present\", function () {",
              "  const json = pm.response.json();",
              "  pm.expect(json).to.have.property(\"user\");",
              "  pm.expect(json.user).to.have.property(\"username\", \"testuser\");",
              "  pm.expect(json.user).to.have.property(\"role\", \"student-admin\");",
              "});",
              "",
              "pm.test(\"Message confirms JWT auth\", function () {",
              "  const json = pm.response.json();",
              "  pm.expect(json.message).to.include(\"authenticated with JWT\");",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ]
    },
    {
      "name": "Auth - Login Cookie - POST /auth/login-cookie",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"username\": \"testuser\",\n  \"password\": \"password123\"\n}"
        },
        "url": {
          "raw": "http://localhost:3000/auth/login-cookie",
          "protocol": "http",
          "host": [
            "localhost"
          ],
          "port": "3000",
          "path": [
            "auth",
            "login-cookie"
          ]
        }
      },
      "response": [],
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 200\", function () {",
              "  pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test(\"sessionId cookie set\", function () {",
              "  pm.response.to.have.header(\"Set-Cookie\");",
              "  const setCookieHeaders = pm.response.headers.filter(h => h.key.toLowerCase() === \"set-cookie\");",
              "  const hasSessionCookie = setCookieHeaders.some(h => h.value.startsWith(\"sessionId=\"));",
              "  pm.expect(hasSessionCookie).to.be.true;",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ]
    },
    {
      "name": "Auth - Me Cookie - GET /auth/me-cookie",
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "http://localhost:3000/auth/me-cookie",
          "protocol": "http",
          "host": [
            "localhost"
          ],
          "port": "3000",
          "path": [
            "auth",
            "me-cookie"
          ]
        }
      },
      "response": [],
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 200\", function () {",
              "  pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test(\"User info from cookie auth\", function () {",
              "  const json = pm.response.json();",
              "  pm.expect(json).to.have.property(\"user\");",
              "  pm.expect(json.user).to.have.property(\"username\", \"cookieUser\");",
              "});",
              "",
              "pm.test(\"Message confirms cookie auth\", function () {",
              "  const json = pm.response.json();",
              "  pm.expect(json.message).to.include(\"authenticated with a cookie\");",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ]
    },
    {
      "name": "Auth - Logout Cookie - POST /auth/logout-cookie",
      "request": {
        "method": "POST",
        "header": [],
        "url": {
          "raw": "http://localhost:3000/auth/logout-cookie",
          "protocol": "http",
          "host": [
            "localhost"
          ],
          "port": "3000",
          "path": [
            "auth",
            "logout-cookie"
          ]
        }
      },
      "response": [],
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 200\", function () {",
              "  pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test(\"Logout message present\", function () {",
              "  const json = pm.response.json();",
              "  pm.expect(json).to.have.property(\"message\");",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ]
    },
    {
      "name": "Students - List All - GET /students",
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "http://localhost:3000/students",
          "protocol": "http",
          "host": [
            "localhost"
          ],
          "port": "3000",
          "path": [
            "students"
          ]
        }
      },
      "response": [],
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 200\", function () {",
              "  pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test(\"Response has count and data array\", function () {",
              "  const json = pm.response.json();",
              "  pm.expect(json).to.have.property(\"count\");",
              "  pm.expect(json).to.have.property(\"data\");",
              "  pm.expect(json.data).to.be.an(\"array\");",
              "  pm.expect(json.count).to.equal(json.data.length);",
              "});",
              "",
              "pm.test(\"First student has required fields (if any exist)\", function () {",
              "  const json = pm.response.json();",
              "  if (json.data.length > 0) {",
              "    const first = json.data[0];",
              "    pm.expect(first).to.have.property(\"id\");",
              "    pm.expect(first).to.have.property(\"name\");",
              "    pm.expect(first).to.have.property(\"age\");",
              "    pm.expect(first).to.have.property(\"email\");",
              "  }",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ]
    },
    {
      "name": "Students - Get by ID - GET /students/1",
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "http://localhost:3000/students/1",
          "protocol": "http",
          "host": [
            "localhost"
          ],
          "port": "3000",
          "path": [
            "students",
            "1"
          ]
        }
      },
      "response": [],
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 200\", function () {",
              "  pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test(\"Student has id 1\", function () {",
              "  const json = pm.response.json();",
              "  pm.expect(json).to.have.property(\"id\", 1);",
              "});",
              "",
              "pm.test(\"Student object has required fields\", function () {",
              "  const json = pm.response.json();",
              "  pm.expect(json).to.have.property(\"name\");",
              "  pm.expect(json).to.have.property(\"age\");",
              "  pm.expect(json).to.have.property(\"email\");",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ]
    },
    {
      "name": "Students - Create (JWT) - POST /students",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{jwtToken}}"
          },
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"name\": \"Postman Student\",\n  \"age\": 21,\n  \"email\": \"postman.student@example.com\",\n  \"isActive\": true\n}"
        },
        "url": {
          "raw": "http://localhost:3000/students",
          "protocol": "http",
          "host": [
            "localhost"
          ],
          "port": "3000",
          "path": [
            "students"
          ]
        }
      },
      "response": [],
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 201\", function () {",
              "  pm.response.to.have.status(201);",
              "});",
              "",
              "pm.test(\"Student created with id\", function () {",
              "  const json = pm.response.json();",
              "  pm.expect(json).to.have.property(\"student\");",
              "  pm.expect(json.student).to.have.property(\"id\");",
              "});",
              "",
              "pm.test(\"Save created student id\", function () {",
              "  const json = pm.response.json();",
              "  pm.environment.set(\"createdStudentId\", json.student.id);",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ]
    },
    {
      "name": "Students - Update (PUT, JWT) - PUT /students/{{createdStudentId}}",
      "request": {
        "method": "PUT",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{jwtToken}}"
          },
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"name\": \"Updated Postman Student\",\n  \"age\": 25,\n  \"email\": \"updated.postman@example.com\",\n  \"isActive\": false\n}"
        },
        "url": {
          "raw": "http://localhost:3000/students/{{createdStudentId}}",
          "protocol": "http",
          "host": [
            "localhost"
          ],
          "port": "3000",
          "path": [
            "students",
            "{{createdStudentId}}"
          ]
        }
      },
      "response": [],
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 200\", function () {",
              "  pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test(\"Student updated correctly\", function () {",
              "  const json = pm.response.json();",
              "  pm.expect(json).to.have.property(\"student\");",
              "  pm.expect(json.student.name).to.eql(\"Updated Postman Student\");",
              "  pm.expect(json.student.age).to.eql(25);",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ]
    },
    {
      "name": "Students - Partial Update (PATCH, JWT) - PATCH /students/{{createdStudentId}}",
      "request": {
        "method": "PATCH",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{jwtToken}}"
          },
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"age\": 23\n}"
        },
        "url": {
          "raw": "http://localhost:3000/students/{{createdStudentId}}",
          "protocol": "http",
          "host": [
            "localhost"
          ],
          "port": "3000",
          "path": [
            "students",
            "{{createdStudentId}}"
          ]
        }
      },
      "response": [],
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 200\", function () {",
              "  pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test(\"Age field updated only (basic check)\", function () {",
              "  const json = pm.response.json();",
              "  pm.expect(json).to.have.property(\"student\");",
              "  pm.expect(json.student.age).to.eql(23);",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ]
    },
    {
      "name": "Students - Delete (JWT) - DELETE /students/{{createdStudentId}}",
      "request": {
        "method": "DELETE",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{jwtToken}}"
          }
        ],
        "url": {
          "raw": "http://localhost:3000/students/{{createdStudentId}}",
          "protocol": "http",
          "host": [
            "localhost"
          ],
          "port": "3000",
          "path": [
            "students",
            "{{createdStudentId}}"
          ]
        }
      },
      "response": [],
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 200\", function () {",
              "  pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test(\"Deleted student has correct id\", function () {",
              "  const json = pm.response.json();",
              "  const createdId = Number(pm.environment.get(\"createdStudentId\"));",
              "  pm.expect(json).to.have.property(\"student\");",
              "  pm.expect(json.student.id).to.eql(createdId);",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ]
    },
    {
      "name": "Students - Protected (Cookie) - GET /students/protected/cookie-only",
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "http://localhost:3000/students/protected/cookie-only",
          "protocol": "http",
          "host": [
            "localhost"
          ],
          "port": "3000",
          "path": [
            "students",
            "protected",
            "cookie-only"
          ]
        }
      },
      "response": [],
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 200 (if session cookie present)\", function () {",
              "  pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test(\"Cookie-protected message present\", function () {",
              "  const json = pm.response.json();",
              "  pm.expect(json).to.have.property(\"message\");",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ]
    },
    {
      "name": "Students - Protected (JWT) - GET /students/protected/jwt-only",
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{jwtToken}}"
          }
        ],
        "url": {
          "raw": "http://localhost:3000/students/protected/jwt-only",
          "protocol": "http",
          "host": [
            "localhost"
          ],
          "port": "3000",
          "path": [
            "students",
            "protected",
            "jwt-only"
          ]
        }
      },
      "response": [],
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 200\", function () {",
              "  pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test(\"JWT-protected message present\", function () {",
              "  const json = pm.response.json();",
              "  pm.expect(json).to.have.property(\"message\");",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ]
    },
    {
      "name": "Error Case - Invalid ID - GET /students/abc",
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "http://localhost:3000/students/abc",
          "protocol": "http",
          "host": [
            "localhost"
          ],
          "port": "3000",
          "path": [
            "students",
            "abc"
          ]
        }
      },
      "response": [],
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 400\", function () {",
              "  pm.response.to.have.status(400);",
              "});",
              "",
              "pm.test(\"Error message present\", function () {",
              "  const json = pm.response.json();",
              "  pm.expect(json).to.have.property(\"error\");",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ]
    },
    {
      "name": "Error Case - Not Found - GET /students/99999",
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "http://localhost:3000/students/99999",
          "protocol": "http",
          "host": [
            "localhost"
          ],
          "port": "3000",
          "path": [
            "students",
            "99999"
          ]
        }
      },
      "response": [],
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 404\", function () {",
              "  pm.response.to.have.status(404);",
              "});",
              "",
              "pm.test(\"Error message present\", function () {",
              "  const json = pm.response.json();",
              "  pm.expect(json).to.have.property(\"error\");",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ]
    },
    {
      "name": "Error Case - Create Student Missing Fields - POST /students",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{jwtToken}}"
          },
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"name\": \"Invalid Student\"\n}"
        },
        "url": {
          "raw": "http://localhost:3000/students",
          "protocol": "http",
          "host": [
            "localhost"
          ],
          "port": "3000",
          "path": [
            "students"
          ]
        }
      },
      "response": [],
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 400\", function () {",
              "  pm.response.to.have.status(400);",
              "});",
              "",
              "pm.test(\"Validation error present\", function () {",
              "  const json = pm.response.json();",
              "  pm.expect(json).to.have.property(\"error\");",
              "  pm.expect(json.error).to.include(\"Validation failed\");",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ]
    },
    {
      "name": "Error Case - Protected JWT without token - GET /students/protected/jwt-only",
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "http://localhost:3000/students/protected/jwt-only",
          "protocol": "http",
          "host": [
            "localhost"
          ],
          "port": "3000",
          "path": [
            "students",
            "protected",
            "jwt-only"
          ]
        }
      },
      "response": [],
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 401\", function () {",
              "  pm.response.to.have.status(401);",
              "});",
              "",
              "pm.test(\"Error message for missing auth header\", function () {",
              "  const json = pm.response.json();",
              "  pm.expect(json).to.have.property(\"error\");",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ]
    },
    {
      "name": "Error Case - Protected Cookie without session - GET /students/protected/cookie-only",
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "http://localhost:3000/students/protected/cookie-only",
          "protocol": "http",
          "host": [
            "localhost"
          ],
          "port": "3000",
          "path": [
            "students",
            "protected",
            "cookie-only"
          ]
        }
      },
      "response": [],
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 401\", function () {",
              "  pm.response.to.have.status(401);",
              "});",
              "",
              "pm.test(\"Error message for missing session cookie\", function () {",
              "  const json = pm.response.json();",
              "  pm.expect(json).to.have.property(\"error\");",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ]
    }
  ],
  "variable": [
    {
      "key": "jwtToken",
      "value": ""
    },
    {
      "key": "createdStudentId",
      "value": ""
    }
  ]
}